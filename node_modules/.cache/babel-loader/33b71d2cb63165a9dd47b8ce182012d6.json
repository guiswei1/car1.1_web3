{"ast":null,"code":"var _jsxFileName = \"/Users/lcst/hv/hv1.1-web3/src/App.js\";\nimport React, { Component } from 'react';\nimport Web3 from \"web3\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.DidMount = () => {\n      //判断页面是否安装Metamask\n      if (typeof window.ethereum !== 'undefined') {\n        const ethereum = window.ethereum; //禁止自动刷新，metamask要求写的\n\n        ethereum.autoRefreshOnNetworkChange = false;\n\n        try {\n          //第一次链接Metamask\n          const accounts = ethereum.enable();\n          console.log(accounts); //初始化Provider\n\n          const provider = window['ethereum'];\n          console.log(provider); //获取网络ID\n\n          console.log(provider.chainId); //实例化Web3\n\n          const web3 = new Web3(provider);\n          console.log(web3); //导入abi文件\n\n          const abi = require(\"./contract.abi.json\"); //定义合约地址\n\n\n          const address = \"0xF22277851468603d581caFF1aa3F279dba8ADB2E\"; //实例化合约\n\n          window.myContract = new web3.eth.Contract(abi.abi, address);\n          console.log(window.myContract);\n          window.defaultAccount = accounts[0].toLowerCase();\n          console.log(window.defaultAccount);\n          ethereum.on('accountsChanged', function (accounts) {\n            console.log(\"accountsChanged:\" + accounts);\n          });\n          ethereum.on('networkChanged', function (networkVersion) {\n            console.log(\"networkChanged:\" + networkVersion);\n          });\n        } catch (e) {}\n      } else {\n        console.log('没有metamask');\n      }\n    };\n\n    this.GetterPendingItem = () => {\n      //查询用户未释放的token数量\n      var unReleased = 0;\n      var totalReleased = 0;\n      var totalAmount = 0;\n      window.myContract.methods.unReleased(window.defaultAccount).call({\n        from: window.defaultAccount\n      }).then(value => {\n        console.log(value);\n        unReleased = value * Math.pow(10, -18);\n        this.setState({\n          unReleased: unReleased\n        });\n      }); //查询用户存进去的token目前释放了多少\n\n      window.myContract.methods.totalReleased(window.defaultAccount).call({\n        from: window.defaultAccount\n      }).then(value => {\n        console.log(value);\n        totalReleased = value * Math.pow(10, -18);\n        this.setState({\n          totalReleased: totalReleased\n        });\n      });\n      totalAmount = unReleased + totalReleased;\n      this.setState({\n        totalAmount: totalAmount\n      }); //户可以取出来的token数量\n\n      window.myContract.methods.withrawable(window.defaultAccount).call({\n        from: window.defaultAccount\n      }).then(value => {\n        console.log(value);\n        this.setState({\n          withrawable: value * Math.pow(10, -18)\n        });\n      });\n    };\n\n    this.Harvest = () => {\n      window.myContract.methods.harvest().send({\n        from: window.defaultAccount\n      }).on('transactionHash', transactionHash => {\n        console.log('transactionHash', transactionHash);\n      }).on('confirmation', (confirmationNumber, receipt) => {\n        console.log({\n          confirmationNumber: confirmationNumber,\n          receipt: receipt\n        });\n      }).on('receipt', receipt => {\n        console.log({\n          receipt: receipt\n        });\n      }).on('error', (error, receipt) => {\n        console.log({\n          error: error,\n          receipt: receipt\n        });\n      });\n    };\n\n    this.state = {\n      totalAmount: 0,\n      withrawable: 0,\n      unReleased: 0,\n      totalReleased: 0\n    };\n  }\n\n  async componentDidMount() {\n    //判断页面是否安装Metamask\n    if (typeof window.ethereum !== 'undefined') {\n      const ethereum = window.ethereum; //禁止自动刷新，metamask要求写的\n\n      ethereum.autoRefreshOnNetworkChange = false;\n\n      try {\n        //第一次链接Metamask\n        const accounts = await ethereum.enable();\n        console.log(accounts); //初始化Provider\n\n        const provider = window['ethereum'];\n        console.log(provider); //获取网络ID\n\n        console.log(provider.chainId); //实例化Web3\n\n        const web3 = new Web3(provider);\n        console.log(web3); //导入abi文件\n\n        const abi = require(\"./contract.abi.json\"); //定义合约地址\n\n\n        const address = \"0xF22277851468603d581caFF1aa3F279dba8ADB2E\"; //实例化合约\n\n        window.myContract = new web3.eth.Contract(abi.abi, address);\n        console.log(window.myContract);\n        window.defaultAccount = accounts[0].toLowerCase();\n        console.log(window.defaultAccount);\n        ethereum.on('accountsChanged', function (accounts) {\n          console.log(\"accountsChanged:\" + accounts);\n        });\n        ethereum.on('networkChanged', function (networkVersion) {\n          console.log(\"networkChanged:\" + networkVersion);\n        });\n      } catch (e) {}\n    } else {\n      console.log('没有metamask');\n    }\n  } //链接钱包\n\n\n  render() {\n    /*#__PURE__*/\n    _jsxDEV(\"button\", {\n      onClick: () => {\n        this.ComponentDidMount();\n      },\n      children: \"\\u94FE\\u63A5\\u94B1\\u5305\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 3\n    }, this);\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\u7528\\u6237\\u672A\\u91CA\\u653E\\u6570\\u91CF:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\" \", this.state.unReleased]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 35\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 72\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\u7528\\u6237\\u5DF2\\u7ECF\\u653E\\u6570\\u91CF:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\" \", this.state.totalReleased]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 35\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 76\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\u4ECA\\u65E5\\u5F85\\u9886\\u53D6\\u6570\\u989D:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: this.state.withrawable\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 37\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 74\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            this.GetterPendingItem();\n          },\n          children: \"\\u67E5\\u8D28\\u62BC\\u4FE1\\u606F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            this.Harvest();\n          },\n          children: \"\\u4ECA\\u65E5\\u5F85\\u9886\\u53D6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 5\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/lcst/hv/hv1.1-web3/src/App.js"],"names":["React","Component","Web3","App","constructor","props","DidMount","window","ethereum","autoRefreshOnNetworkChange","accounts","enable","console","log","provider","chainId","web3","abi","require","address","myContract","eth","Contract","defaultAccount","toLowerCase","on","networkVersion","e","GetterPendingItem","unReleased","totalReleased","totalAmount","methods","call","from","then","value","Math","pow","setState","withrawable","Harvest","harvest","send","transactionHash","confirmationNumber","receipt","error","state","componentDidMount","render","ComponentDidMount"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Web3 from \"web3\";\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      totalAmount:0,\n      withrawable:0,\n      unReleased:0,\n      totalReleased:0\n    };\n  }\nasync componentDidMount() {\n  //判断页面是否安装Metamask\n  if (typeof window.ethereum !== 'undefined') {\n    const ethereum = window.ethereum\n    //禁止自动刷新，metamask要求写的\n    ethereum.autoRefreshOnNetworkChange = false\n\n    try {\n      //第一次链接Metamask\n      const accounts = await ethereum.enable()\n      console.log(accounts)\n      //初始化Provider\n      const provider = window['ethereum']\n      console.log(provider)\n      //获取网络ID\n      console.log(provider.chainId)\n      //实例化Web3\n      const web3 = new Web3(provider)\n      console.log(web3)\n      //导入abi文件\n      const abi = require(\"./contract.abi.json\")\n      //定义合约地址\n      const address = \"0xF22277851468603d581caFF1aa3F279dba8ADB2E\"\n      //实例化合约\n      window.myContract = new web3.eth.Contract(abi.abi,address)\n      console.log(window.myContract)\n      window.defaultAccount = accounts[0].toLowerCase()\n      console.log(window.defaultAccount)\n\n      ethereum.on('accountsChanged', function (accounts) {\n        console.log(\"accountsChanged:\" + accounts)\n      })\n      ethereum.on('networkChanged', function (networkVersion) {\n        console.log(\"networkChanged:\" + networkVersion)\n      })\n    } catch (e) {\n\n    }\n  } else {\n    console.log('没有metamask')\n  }\n}\n\n//链接钱包\nDidMount =() => {\n  //判断页面是否安装Metamask\n  if (typeof window.ethereum !== 'undefined') {\n    const ethereum = window.ethereum\n    //禁止自动刷新，metamask要求写的\n    ethereum.autoRefreshOnNetworkChange = false\n\n    try {\n      //第一次链接Metamask\n      const accounts =  ethereum.enable()\n      console.log(accounts)\n      //初始化Provider\n      const provider = window['ethereum']\n      console.log(provider)\n      //获取网络ID\n      console.log(provider.chainId)\n      //实例化Web3\n      const web3 = new Web3(provider)\n      console.log(web3)\n      //导入abi文件\n      const abi = require(\"./contract.abi.json\")\n      //定义合约地址\n      const address = \"0xF22277851468603d581caFF1aa3F279dba8ADB2E\"\n      //实例化合约\n      window.myContract = new web3.eth.Contract(abi.abi,address)\n      console.log(window.myContract)\n      window.defaultAccount = accounts[0].toLowerCase()\n      console.log(window.defaultAccount)\n\n      ethereum.on('accountsChanged', function (accounts) {\n        console.log(\"accountsChanged:\" + accounts)\n      })\n      ethereum.on('networkChanged', function (networkVersion) {\n        console.log(\"networkChanged:\" + networkVersion)\n      })\n    } catch (e) {\n\n    }\n  } else {\n    console.log('没有metamask')\n  }\n}\n\nGetterPendingItem = () => {\n  //查询用户未释放的token数量\n  var unReleased = 0;\n  var totalReleased = 0;\n  var totalAmount = 0;\n  window.myContract.methods.unReleased(window.defaultAccount).call({from:window.defaultAccount}).then(value=>{\n    console.log(value)\n    unReleased = value * Math.pow(10,-18);\n    this.setState({unReleased:unReleased})\n  })\n//查询用户存进去的token目前释放了多少\n  window.myContract.methods.totalReleased(window.defaultAccount).call({from:window.defaultAccount}).then(value=>{\n    console.log(value)\n    totalReleased = value * Math.pow(10,-18);\n    this.setState({totalReleased:totalReleased})\n  })\n  totalAmount = unReleased+totalReleased;\nthis.setState({totalAmount:totalAmount})\n\n//户可以取出来的token数量\nwindow.myContract.methods.withrawable(window.defaultAccount).call({from:window.defaultAccount}).then(value=>{\n  console.log(value)\n  this.setState({withrawable:value * Math.pow(10,-18)})\n})\n\n\n}\n\n //领取\nHarvest =() =>{ \n  window.myContract.methods.harvest().send({from:window.defaultAccount})\n  .on('transactionHash',(transactionHash)=>{\n    console.log('transactionHash',transactionHash)\n  })\n  .on('confirmation',(confirmationNumber,receipt)=>{\n    console.log({ confirmationNumber: confirmationNumber, receipt: receipt })\n  })\n  .on('receipt',(receipt)=>{\n    console.log({ receipt: receipt })\n  })\n  .on('error',(error,receipt)=>{\n    console.log({ error: error, receipt: receipt })\n  })\n}\nrender() {\n  <button onClick={() => { this.ComponentDidMount() }}>链接钱包</button>\n  return (\n    <div>\n        <div>\n          <label >用户未释放数量:</label><span> {this.state.unReleased}</span><br/>\n          <label >用户已经放数量:</label><span> {this.state.totalReleased}</span> <br/>\n            <label >今日待领取数额:</label><span>{this.state.withrawable}</span><br/>\n         </div>\n      <div></div>\n      <div>\n        <button onClick={() => { this.GetterPendingItem() }}>查质押信息</button>\n      </div>\n      <div>\n        <button onClick={() => { this.Harvest() }}>今日待领取</button>\n      </div>\n      <div></div>\n    </div>\n  );\n}\n}export default App;"]},"metadata":{},"sourceType":"module"}